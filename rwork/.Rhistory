totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust))
listg2[[8]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust))
df.galaxy<-data.frame()
for(i in 1:8){
df.galaxy<-rbind(df.galaxy,listg2[[i]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust)))
}
df.galaxy.nrc<-data.frame(df.galaxy,row.names=c("1_galaxys6","2_galaxys7","3_galaxys8","4_galaxys8p","5_galaxys9","6_galaxys9p","7_galaxys10","8_galaxys10p"))
df.galaxy.nrc
inner_join(as.data.frame(listg[1]),get_sentiments("nrc"))
df.galaxy.nrc<-data.frame(df.galaxy,row.names=c("1_galaxys6","2_galaxys7","3_galaxys8","4_galaxys8p","5_galaxys9","6_galaxys9p","7_galaxys10","8_galaxys10p"))
df.galaxy.nrc
df.iphone.nrc<-data.frame(df.iphone,row.names=c("iphone5","iphone6","iphone6s","iphone7","iphone7p","iphone8","iphone8p","iphonex"))
df.iphone.nrc
for(i in 1:8){
df.iphone<-rbind(df.iphone,listi2[[i]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust)))
}
df.iphone.nrc<-data.frame(df.iphone,row.names=c("iphone5","iphone6","iphone6s","iphone7","iphone7p","iphone8","iphone8p","iphonex"))
df.iphone.nrc
for(i in 1:8){
df.iphone<-rbind(df.iphone,listi2[[i]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust)))
}
df.iphone.nrc<-data.frame(df.iphone,row.names=c("iphone5","iphone6","iphone6s","iphone7","iphone7p","iphone8","iphone8p","iphonex"))
listi2<-list()
for(i in 1:8){
listi2[[i]]<-inner_join(as.data.frame(listi[[i]]),get_sentiments("nrc"))
}
listi2[[2]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust))
df.iphone<-data.frame()
for(i in 1:8){
df.iphone<-rbind(df.iphone,listi2[[i]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust)))
}
df.iphone.nrc<-data.frame(df.iphone,row.names=c("iphone5","iphone6","iphone6s","iphone7","iphone7p","iphone8","iphone8p","iphonex"))
df.iphone.nrc
iphoneReviews<-VCorpus(DirSource("Data/iphone/"))
iphoneReviews
str(iphoneReviews)
iphoneReviews<-tm_map(iphoneReviews,content_transformer(tolower))
mytempfunct<-function(myobject, oldexp, newexp){
tm_map(myobject,
content_transformer(function(x,pattern) gsub(pattern, newexp,x)),
oldexp)
}
iphoneReviews<-mytempfunct(iphoneReviews,"[[:digit:]]{1,}","")
iphoneReviews<-mytempfunct(iphoneReviews,"[[:punct:]]{1,}"," ")
iphoneReviews<-mytempfunct(iphoneReviews,"[[:space:]]{1,}"," ")
#불용어제거
iphoneReviews<-tm_map(iphoneReviews,removeWords,words=stopwords("SMART"))
myiphone<-c(rep(NA,8))
for(i in 1:8){
myiphone[i]<-as.character(iphoneReviews[[i]][1])
}
str(myiphone[3])
length(myiphone[3])
my.df.text2<-data_frame(iphone.id=1:8, doc=myiphone)
my.df.text.word2<-my.df.text2 %>%
unnest_tokens(word,doc)
my.df.text.word2
get_sentiments("bing")
#bing
myiphone.result<-my.df.text.word2 %>%
inner_join(get_sentiments("bing")) %>%
count(word,iphone.id,sentiment) %>%
spread(sentiment,n,fill=0)
my.df.text.word2
table(my.df.text.word2$iphone.id)
#bing
myiphone.result<-my.df.text.word2 %>%
inner_join(get_sentiments("bing")) %>%
count(word,iphone.id,sentiment) %>%
spread(sentiment,n,fill=0)
myiphone.result %>% arrange(desc(negative))
myiphone.result %>% arrange(desc(positive))
#bing
get_sentiments("afinn")
myiphone.result<-my.df.text.word2 %>%
inner_join(get_sentiments("afinn")) %>%
count(word,iphone.id,score)
myiphone.result
iphone.scoreby.id<-myiphone.result %>%
group_by(iphone.id) %>%
summarise(score=mean(score*n))
iphone.scoreby.id$iphone.id<-c("iphone5","iphone6","iphone6s","iphone7","iphone7p","iphone8","iphone8p","iphonex")
iphone.scoreby.id
library(ggplot2)
ggplot(data=iphone.scoreby.id,aes(x=iphone.id,y=score)) + geom_col()
iphone.scoreby.id$group<-c(rep("iphone",8))
galaxy.scoreby.id$group<-c(rep("galaxy",8))
iphone.scoreby.id$galaxy.id<-c(rep(NA,8))
galaxy.scoreby.id$iphone.id<-c(rep(NA,8))
iphone.scoreby.id$seq<-c(seq(1:8))
galaxy.scoreby.id$seq<-c(seq(1:8))
iphone.scoreby.id$id<-iphone.scoreby.id$iphone.id
galaxy.scoreby.id$id<-galaxy.scoreby.id$galaxy.id
compare.iphone.galaxy<-rbind(iphone.scoreby.id,galaxy.scoreby.id)
compare.iphone.galaxy
ggplot(data=compare.iphone.galaxy,aes(x=id,y=score,color=group)) + geom_point()
ggplot(data=compare.iphone.galaxy,aes(x=seq,y=score,color=group)) + geom_line(size=2) + ylim(c(0,15))
#각 라인마다 가장 많이 나온 단어
#galaxy
my.df.text.word
my.df.text.word$word
g1<-my.df.text.word %>%
filter(galaxy.id==1) %>%
count(word)
g1 %>% arrange(desc(n))
g2<-my.df.text.word %>%
filter(galaxy.id==2) %>%
count(word)
g2 %>% arrange(desc(n))
#nrc 사전 분류에 따른 단어 제품군 별 얼마나 나왔는지
listg<-list()
table(my.df.text.word$galaxy.id)
for(i in 1:8){
listg[[i]]<-my.df.text.word %>%
filter(galaxy.id==i) %>%
count(word) %>%
arrange(desc(n))
}
listg[[1]]
listg2<-list()
for(i in 1:8){
listg2[[i]]<-inner_join(as.data.frame(listg[[i]]),get_sentiments("nrc"))
}
listg2[[8]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust))
df.galaxy<-data.frame()
for(i in 1:8){
df.galaxy<-rbind(df.galaxy,listg2[[i]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust)))
}
df.galaxy.nrc<-data.frame(df.galaxy,row.names=c("1_galaxys6","2_galaxys7","3_galaxys8","4_galaxys8p","5_galaxys9","6_galaxys9p","7_galaxys10","8_galaxys10p"))
df.galaxy.nrc
inner_join(as.data.frame(listg[1]),get_sentiments("nrc"))
#iphone
listi<-list()
for(i in 1:8){
listi[[i]]<-my.df.text.word2 %>%
filter(iphone.id==i) %>%
count(word) %>%
arrange(desc(n))
}
listi[[4]]
listi2<-list()
for(i in 1:8){
listi2[[i]]<-inner_join(as.data.frame(listi[[i]]),get_sentiments("nrc"))
}
listi2[[2]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust))
df.iphone<-data.frame()
for(i in 1:8){
df.iphone<-rbind(df.iphone,listi2[[i]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust)))
}
df.iphone.nrc<-data.frame(df.iphone,row.names=c("iphone5","iphone6","iphone6s","iphone7","iphone7p","iphone8","iphone8p","iphonex"))
df.iphone.nrc
iphone.scoreby.id$seq<-c(seq(6,6.5,7,7.5,8,8.5,9,10))
galaxy.scoreby.id$seq<-c(seq(6,6.5,7,7.5,8,8.5,9,10))
iphone.scoreby.id$seq<-c(6,6.5,7,7.5,8,8.5,9,10)
galaxy.scoreby.id$seq<-c(6,6.5,7,7.5,8,8.5,9,10)
ggplot(data=compare.iphone.galaxy,aes(x=seq,y=score,color=group)) + geom_line(size=2) + ylim(c(0,15))
compare.iphone.galaxy<-rbind(iphone.scoreby.id,galaxy.scoreby.id)
compare.iphone.galaxy
ggplot(data=compare.iphone.galaxy,aes(x=id,y=score,color=group)) + geom_point()
ggplot(data=compare.iphone.galaxy,aes(x=seq,y=score,color=group)) + geom_line(size=2) + ylim(c(0,15))
iphone.scoreby.id$generation<-c(6,6.5,7,7.5,8,8.5,9,10)
galaxy.scoreby.id$generation<-c(6,6.5,7,7.5,8,8.5,9,10)
iphone.scoreby.id$id<-iphone.scoreby.id$iphone.id
galaxy.scoreby.id$id<-galaxy.scoreby.id$galaxy.id
compare.iphone.galaxy<-rbind(iphone.scoreby.id,galaxy.scoreby.id)
compare.iphone.galaxy
ggplot(data=compare.iphone.galaxy,aes(x=id,y=score,color=group)) + geom_point()
ggplot(data=compare.iphone.galaxy,aes(x=generation,y=score,color=group)) + geom_line(size=2) + ylim(c(0,15))
#kaggle 자료 활용
movieSent<-read.csv(file="Data/movieSent/train.tsv",
header=T,
sep="\t",
na.strings = c("NA",""),
stringsAsFactors = F)
movieSent
View(movieSent)
str(movieSent)
moviePharse<-movieSent$Phrase
str(moviePharse)
moviePharse
library(tidytext)
library(tidyr)
my.df.text<-data_frame(moviePharse)
my.df.text
my.df.text.word<-my.df.text %>%
unnest_tokens(word,moviePharse)
my.df.text.word
#get_sentiments("bing")
get_sentiments("afinn")
myresult<-inner_join(my.df.text.word,get_sentiments("afinn"))
myresult<-myresult %>%
count(word,score)
mysummarise<-myresult %>%
group_by(word) %>%
summarise(eachscore=score*n)
#뭐 걍 합 때려보면 꽤나 positive하게 나온다 : 점수가 47100
mean(mysummarise$eachscore)
View(myresult)
mysummarise<-myresult %>%
group_by(word) %>%
summarise(eachscore=score*n)
#뭐 걍 합 때려보면 꽤나 positive하게 나온다 : 점수가 47100
mean(mysummarise$eachscore)
mysummarise
sum(mysummarise$eachscore)
myresult<-inner_join(my.df.text.word,get_sentiments("bing"))
myresult
myresult<-myresult %>%
count(word,sentiment)
myresult
mysummarise<-myresult %>%
spread(sentiment, n,fill=0) %>%
summarise(totNeg=sum(negative),totPos=sum(positive))
mysummarise
myresult<-inner_join(my.df.text.word,get_sentiments("nrc"))
myresult
myresult<-myresult %>%
count(word,sentiment)
myresult
myresult %>%
spread(sentiment, n, fill=0)
mysummarise<-myresult %>%
spread(sentiment, n, fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust))
mysummarise
#뭐 걍 합 때려보면 꽤나 positive하게 나온다 : 점수가 47100
mean(mysummarise$eachscore)
#뭐 걍 합 때려보면 꽤나 positive하게 나온다 : 점수가 47100
mean(mysummarise$eachscore)
mysummarise<-myresult %>%
group_by(word) %>%
summarise(eachscore=score*n)
sum(mysummarise$eachscore)
my.df.text<-data_frame(moviePharse)
my.df.text
my.df.text.word<-my.df.text %>%
unnest_tokens(word,moviePharse)
my.df.text.word
#get_sentiments("bing")
get_sentiments("afinn")
myresult<-inner_join(my.df.text.word,get_sentiments("afinn"))
myresult<-myresult %>%
count(word,score)
mysummarise<-myresult %>%
group_by(word) %>%
summarise(eachscore=score*n)
sum(mysummarise$eachscore)
#뭐 걍 합 때려보면 꽤나 positive하게 나온다 : 점수가 47100
mean(mysummarise$eachscore)
my.df.text.word
my.df.text
movieScore<-movieSent$Sentiment
mean(movieScore)
#kaggle 자료 활용
movieSent<-read.csv(file="Data/movieSent/train.tsv",
header=T,
sep="\t",
na.strings = c("NA",""),
stringsAsFactors = F)
moviePharse<-movieSent$Phrase
moviePharse
movieScore<-movieSent$Sentiment
mean(movieScore)
myresult<-inner_join(my.df.text.word,get_sentiments("afinn"))
myresult
myresult %>% arrange(desc(score))
myresult %>% arrange(score)
mysummarise<-myresult %>%
group_by(word) %>%
summarise(eachscore=score*n)
myresult<-inner_join(my.df.text.word,get_sentiments("afinn"))
myresult %>% arrange(score)
myresult<-myresult %>%
count(word,score)
mysummarise<-myresult %>%
group_by(word) %>%
summarise(eachscore=score*n)
mysummarise %>% arrange(eachscore)
mysummarise %>% arrange(desc(eachscore))
mean(mysummarise$eachscore)
sum(mysummarise$eachscore)
galaxyReviews<-VCorpus(DirSource("Data/galaxy/"))
galaxyReviews
str(galaxyReviews)
#galaxyReviews[[1]]$content
#galaxyReviews<-tm_map(galaxyReviews,removeNumbers)
#galaxyReviews<-tm_map(galaxyReviews,removePunctuation)
galaxyReviews<-tm_map(galaxyReviews,content_transformer(tolower))
mytempfunct<-function(myobject, oldexp, newexp){
tm_map(myobject,
content_transformer(function(x,pattern) gsub(pattern, newexp,x)),
oldexp)
}
galaxyReviews<-mytempfunct(galaxyReviews,"[[:digit:]]{1,}","")
galaxyReviews<-mytempfunct(galaxyReviews,"[[:punct:]]{1,}"," ")
galaxyReviews<-mytempfunct(galaxyReviews,"[[:space:]]{1,}"," ")
#불용어제거
galaxyReviews<-tm_map(galaxyReviews,removeWords,words=stopwords("SMART"))
mygalaxy<-c(rep(NA,8))
for(i in 1:8){
mygalaxy[i]<-as.character(galaxyReviews[[i]][1])
}
my.df.text<-data_frame(galaxy.id=1:8, doc=mygalaxy)
my.df.text.word<-my.df.text %>%
unnest_tokens(word,doc)
my.df.text.word
my.df.text.word
#bing
mygalaxy.result<-my.df.text.word %>%
inner_join(get_sentiments("bing")) %>%
count(word,galaxy.id,sentiment) %>%
spread(sentiment,n,fill=0)
#bing
mygalaxy.result<-my.df.text.word %>%
inner_join(get_sentiments("bing")) %>%
count(word,galaxy.id,sentiment) %>%
spread(sentiment,n,fill=0)
mygalaxy.result %>% arrange(desc(negative))
mygalaxy.result %>% arrange(desc(positive))
mygalaxy.result %>% arrange(desc(negative))
mygalaxy.result %>% arrange(desc(positive))
myiphone.result %>% arrange(desc(negative))
#bing
myiphone.result<-my.df.text.word2 %>%
inner_join(get_sentiments("bing")) %>%
count(word,iphone.id,sentiment) %>%
spread(sentiment,n,fill=0)
myiphone.result %>% arrange(desc(negative))
myiphone.result %>% arrange(desc(positive))
mygalaxy.result<-my.df.text.word %>%
inner_join(get_sentiments("afinn")) %>%
count(word,galaxy.id,score)
mygalaxy.result
galaxy.scoreby.id<-mygalaxy.result %>%
group_by(galaxy.id) %>%
summarise(score=mean(score*n))
galaxy.scoreby.id$galaxy.id<-c("1_galaxys6","2_galaxys7","3_galaxys8","4_galaxys8p","5_galaxys9","6_galaxys9p","7_galaxys10","8_galaxys10p")
galaxy.scoreby.id
library(ggplot2)
ggplot(data=galaxy.scoreby.id,aes(x=galaxy.id,y=score)) + geom_col()
iphoneReviews<-VCorpus(DirSource("Data/iphone/"))
iphoneReviews
str(iphoneReviews)
iphoneReviews<-tm_map(iphoneReviews,content_transformer(tolower))
mytempfunct<-function(myobject, oldexp, newexp){
tm_map(myobject,
content_transformer(function(x,pattern) gsub(pattern, newexp,x)),
oldexp)
}
iphoneReviews<-mytempfunct(iphoneReviews,"[[:digit:]]{1,}","")
iphoneReviews<-mytempfunct(iphoneReviews,"[[:punct:]]{1,}"," ")
iphoneReviews<-mytempfunct(iphoneReviews,"[[:space:]]{1,}"," ")
#불용어제거
iphoneReviews<-tm_map(iphoneReviews,removeWords,words=stopwords("SMART"))
myiphone<-c(rep(NA,8))
for(i in 1:8){
myiphone[i]<-as.character(iphoneReviews[[i]][1])
}
str(myiphone[3])
length(myiphone[3])
my.df.text2<-data_frame(iphone.id=1:8, doc=myiphone)
my.df.text.word2<-my.df.text2 %>%
unnest_tokens(word,doc)
my.df.text.word2
table(my.df.text.word2$iphone.id)
get_sentiments("bing")
#bing
myiphone.result<-my.df.text.word2 %>%
inner_join(get_sentiments("bing")) %>%
count(word,iphone.id,sentiment) %>%
spread(sentiment,n,fill=0)
myiphone.result %>% arrange(desc(negative))
myiphone.result %>% arrange(desc(positive))
#afinn
get_sentiments("afinn")
myiphone.result<-my.df.text.word2 %>%
inner_join(get_sentiments("afinn")) %>%
count(word,iphone.id,score)
myiphone.result
iphone.scoreby.id<-myiphone.result %>%
group_by(iphone.id) %>%
summarise(score=mean(score*n))
iphone.scoreby.id$iphone.id<-c("iphone5","iphone6","iphone6s","iphone7","iphone7p","iphone8","iphone8p","iphonex")
iphone.scoreby.id
library(ggplot2)
ggplot(data=iphone.scoreby.id,aes(x=iphone.id,y=score)) + geom_col()
iphone.scoreby.id$group<-c(rep("iphone",8))
galaxy.scoreby.id$group<-c(rep("galaxy",8))
iphone.scoreby.id$galaxy.id<-c(rep(NA,8))
galaxy.scoreby.id$iphone.id<-c(rep(NA,8))
iphone.scoreby.id$generation<-c(6,6.5,7,7.5,8,8.5,9,10)
galaxy.scoreby.id$generation<-c(6,6.5,7,7.5,8,8.5,9,10)
iphone.scoreby.id$id<-iphone.scoreby.id$iphone.id
galaxy.scoreby.id$id<-galaxy.scoreby.id$galaxy.id
compare.iphone.galaxy<-rbind(iphone.scoreby.id,galaxy.scoreby.id)
compare.iphone.galaxy
ggplot(data=compare.iphone.galaxy,aes(x=generation,y=score,color=group)) + geom_line(size=2) +
ylim(c(0,15))
#각 라인마다 가장 많이 나온 단어
#galaxy
my.df.text.word
my.df.text.word$word
#nrc 사전 분류에 따른 단어 제품군 별 얼마나 나왔는지
listg<-list()
table(my.df.text.word$galaxy.id)
for(i in 1:8){
listg[[i]]<-my.df.text.word %>%
filter(galaxy.id==i) %>%
count(word) %>%
arrange(desc(n))
}
listg[[1]]
listg2<-list()
for(i in 1:8){
listg2[[i]]<-inner_join(as.data.frame(listg[[i]]),get_sentiments("nrc"))
}
listg2[[8]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust))
df.galaxy<-data.frame()
for(i in 1:8){
df.galaxy<-rbind(df.galaxy,listg2[[i]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust)))
}
df.galaxy.nrc<-data.frame(df.galaxy,row.names=c("1_galaxys6","2_galaxys7","3_galaxys8","4_galaxys8p","5_galaxys9","6_galaxys9p","7_galaxys10","8_galaxys10p"))
df.galaxy.nrc
df.galaxy.nrc
#iphone
listi<-list()
for(i in 1:8){
listi[[i]]<-my.df.text.word2 %>%
filter(iphone.id==i) %>%
count(word) %>%
arrange(desc(n))
}
listi2<-list()
for(i in 1:8){
listi2[[i]]<-inner_join(as.data.frame(listi[[i]]),get_sentiments("nrc"))
}
df.iphone<-data.frame()
for(i in 1:8){
df.iphone<-rbind(df.iphone,listi2[[i]] %>%
spread(sentiment,n,fill=0) %>%
summarise(totAng=sum(anger),totAnt=sum(anticipation),
totDis=sum(disgust),totFear=sum(fear),totJoy=sum(joy),
totNeg=sum(negative),totPos=sum(positive),totSad=sum(sadness),
totSur=sum(surprise),totTrust=sum(trust)))
}
df.iphone.nrc<-data.frame(df.iphone,row.names=c("iphone5","iphone6","iphone6s","iphone7","iphone7p","iphone8","iphone8p","iphonex"))
df.iphone.nrc
